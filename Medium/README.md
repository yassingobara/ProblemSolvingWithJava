Check the code comments for explanation. 

